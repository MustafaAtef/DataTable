class Pagination{constructor(t,e){this.tableConatiner=t,this.paginationHandler=e}renderPagination(t,e){if(e<=5)if(t){let a=this.tableConatiner.querySelector(".pagination__items"),n=this.CPIForMaxFivePages(e,t);a.innerHTML=n}else{let t=this.createPaginationElement(),a=this.CPIForMaxFivePages(e);t.paginationUl.innerHTML=a;let n=this.tableConatiner.querySelector(".table-container__pagination");n&&this.tableConatiner.removeChild(n),this.tableConatiner.appendChild(t.paginationContainer)}else if(t){let a=this.tableConatiner.querySelector(".pagination__items"),n=this.CPIForMaxPages(e,t);a.innerHTML=n}else{let t=this.createPaginationElement(),a=this.CPIForMaxPages(e);t.paginationUl.innerHTML=a;let n=this.tableConatiner.querySelector(".table-container__pagination");n&&this.tableConatiner.removeChild(n),this.tableConatiner.appendChild(t.paginationContainer)}}createPaginationElement(){let t=document.createElement("div");t.classList.add("table-container__pagination");let e=document.createElement("ul");return e.classList.add("pagination__items"),e.addEventListener("click",this.paginationHandler),t.appendChild(e),{paginationUl:e,paginationContainer:t}}CPIForMaxFivePages(t,e=1){let a=this.createControlsBtn(t,e),n="";n+=a.prevBtn;for(let a=1;a<=t;a++)n+=a==e?this.createPaginationBtn(a,!0):this.createPaginationBtn(a);return n+=a.nextBtn}CPIForMaxPages(t,e=1){let a=this.createControlsBtn(t,e),n="";if(n+=a.prevBtn,e<5){for(let t=1;t<=5;t++)n+=t==e?this.createPaginationBtn(t,!0):this.createPaginationBtn(t);n+=this.createPlaceholderBtn(),n+=this.createPaginationBtn(t)}else if(e>t-4){n+=this.createPaginationBtn(1),n+=this.createPlaceholderBtn();for(let a=t-4;a<=t;a++)n+=a==e?this.createPaginationBtn(a,!0):this.createPaginationBtn(a)}else n+=this.createPaginationBtn(1),n+=this.createPlaceholderBtn(),n+=this.createPaginationBtn(+e-1),n+=this.createPaginationBtn(e,!0),n+=this.createPaginationBtn(+e+1),n+=this.createPlaceholderBtn(),n+=this.createPaginationBtn(t);return n+=a.nextBtn}createControlsBtn(t,e){return{prevBtn:`\n            <li class="pagination__item">\n                <button class="pagination__item--btn ${1==e?"disabled":""}" data-page="${+e-1}">Previous</button>\n            </li>\n        `,nextBtn:`\n            <li class="pagination__item">\n                <button class="pagination__item--btn ${e==t?"disabled":""}" data-page="${+e+1}">Next</button>\n            </li>\n        `}}createPaginationBtn(t,e=!1){return`\n            <li class="pagination__item">\n                <button class="pagination__item--btn ${e?"active":""}" data-page="${t}">${t}</button>\n            </li>\n        `}createPlaceholderBtn(){return'\n            <li class="pagination__item">\n                <button class="pagination__item--btn disabled">...</button>\n            </li>\n        '}}class DataTable{constructor(t){this.options=t,this.tableContainer=document.querySelector(this.options.table),this.rowsLimit=this.options.rowsLimit||10,this.tableBody=this.tableContainer.querySelector("table tbody"),this.tableBodyItems=Array.from(this.tableBody.children),this.searchedData=this.tableBodyItems,this.maxPages=Math.ceil(this.tableBodyItems.length/this.rowsLimit),this.dataTableHandler()}dataTableHandler(){this.parseData(),this.createDOMElements(),this.options.pagination&&(this.pagination=new Pagination(this.tableContainer,this.paginationHandler.bind(this)),this.renderDataPage())}createDOMElements(){let t=document.createElement("div");t.classList.add("table-controls");let e=0;if(this.options.searchBox){let a=this.createSearchBoxElement();t.appendChild(a),e++}this.options.rowsNumberBox&&(e++,t.appendChild(this.createRowsNumberBox())),e&&this.tableContainer.insertAdjacentElement("afterbegin",t)}createRowsNumberBox(){let t=document.createElement("div");t.classList.add("table-controls__rows");let e=document.createElement("label");e.setAttribute("for","numberOfRows"),e.textContent="Rows: ";let a=document.createElement("select");return a.id="numberOfRows",a.classList.add("form-control"),a.innerHTML='\n                <option value="10">10</option>\n                <option value="20">20</option>\n                <option value="50">50</option>\n                <option value="100">100</option>\n            ',a.addEventListener("change",this.addRowsNumber.bind(this)),t.append(e,a),t}addRowsNumber(t){this.rowsLimit=+t.target.value,this.maxPages=Math.ceil(this.searchedData.length/this.rowsLimit),this.renderDataPage(null,this.maxPages)}createSearchBoxElement(){let t=document.createElement("div");t.classList.add("table-controls__search");let e=document.createElement("lable");e.setAttribute("for","searchInTable"),e.textContent="Search: ";let a=document.createElement("input");return a.type="text",a.id="searchInTable",a.classList.add("form-control"),a.addEventListener("keyup",this.searchHandler.bind(this)),t.append(e,a),t}searchHandler(t){let e=t.target.value,a=[];if(""!==e){for(let t=0;t<this.data.length;t++){JSON.stringify(this.data[t]).includes(e)&&a.push(this.createTableData(this.data[t]))}this.searchedData=a,this.maxPages=Math.ceil(this.searchedData.length/this.rowsLimit)}else this.searchedData=this.tableBodyItems,this.maxPages=Math.ceil(this.tableBodyItems.length/this.rowsLimit);this.renderDataPage(null)}createTableData(t){let e=document.createElement("tr");for(const a in t)e.innerHTML+=`<td>${t[a]}</td>`;return e}parseData(){let t=this.tableBodyItems;this.tableHeaders||(this.tableHeaders=Array.from(this.tableContainer.querySelectorAll("table thead tr th")).map(t=>t.textContent)),this.data=[],Array.from(t).forEach(t=>{let e=t.children,a={};for(let t=0;t<e.length;t++)a[this.tableHeaders[t]]=e[t].textContent;this.data.push(a)})}renderDataPage(t=null){let e,a;t?(e=(+t-1)*this.rowsLimit,a=+t*this.rowsLimit):(e=0,a=this.rowsLimit);let n=Array.from(this.searchedData).slice(e,a),i="";n.forEach(t=>{i+=`${t.outerHTML}`}),this.tableBody.innerHTML=i,this.pagination.renderPagination(t,this.maxPages)}paginationHandler(t){if(t.target.closest(".pagination__item--btn")){let e=t.target.closest(".pagination__item--btn"),a=t.target.closest(".pagination__item--btn").dataset.page;e.classList.contains("active")||e.classList.contains("disabled")||this.renderDataPage(a)}}}let datatable=new DataTable({table:".table-container",searchBox:!0,rowsNumberBox:!0,pagination:!0});